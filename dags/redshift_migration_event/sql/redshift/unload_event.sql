unload ('SELECT insert_time, starttime, eventname, eventid, catid, venueid, dateid, TO_TIMESTAMP(''%(export_datetime)s'', ''YYYY-MM-DD"T"HH24:MI:SS'') as export_datetime, MD5(COALESCE(CAST(insert_time AS VARCHAR), '''') || '', '' || COALESCE(CAST(starttime AS VARCHAR), '''') || '', '' || COALESCE(CAST(eventname AS VARCHAR), '''') || '', '' || COALESCE(CAST(eventid AS VARCHAR), '''') || '', '' || COALESCE(CAST(catid AS VARCHAR), '''') || '', '' || COALESCE(CAST(venueid AS VARCHAR), '''') || '', '' || COALESCE(CAST(dateid AS VARCHAR), '''')) AS checksum FROM dev.public.event WHERE insert_time > ''%(insert_time)s''') to 's3://redshift-sample-data-d001/unload/event/%(export_datetime)s/event_' iam_role DEFAULT FORMAT PARQUET ALLOWOVERWRITE parallel off maxfilesize 100 mb;